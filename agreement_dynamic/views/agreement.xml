<?xml version="1.0" ?>
<odoo>
    <record id="view_agreement_form" model="ir.ui.view">
        <field name="name">agreement.form.view</field>
        <field name="model">agreement</field>
        <field name="inherit_id" ref="agreement.agreement_form" />
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']" position="inside">
                <field name="section_ids" invisible="1" />
                <button
                    type="object"
                    name="action_view_section"
                    class="oe_stat_button"
                    icon="fa-file-text-o"
                    attrs="{'invisible': ['|',('section_count', '=', 0),('signature_date', '!=', False)]}"
                    groups="base.group_user"
                >
                    <field name="section_count" widget="statinfo" string="Sections" />
                </button>
            </xpath>
            <xpath expr="//field[@name='domain']" position="after">
                <field name="resource_ref" />
                <field name="template_id" />
                <button
                    name="action_wizard_sign_agreement"
                    string="Sign agreement"
                    type="object"
                    class="oe_highlight"
                    attrs="{'invisible': [('signature_date', '!=', False)]}"
                    context="{'default_agreement_id': active_id}"
                />
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page name="dynamic_content" string="Dynamic content">
                    <button
                        name="%(agreement_dynamic_document_preview)d"
                        string="Preview"
                        type="action"
                        class="oe_highlight"
                        attrs="{'invisible':[('resource_ref', '=', False)]}"
                    />
                    <field
                        name="section_ids"
                        attrs="{'readonly':[('signature_date', '!=', False)]}"
                    >
                        <tree decoration-bf="is_paragraph">
                            <field name="sequence" widget="handle" />
                            <field name="name" />
                            <field name="is_paragraph" invisible="1" />
                        </tree>
                        <form>
                            <sheet>
                                <div class="oe_title">
                                    <label for="name" class="oe_edit_only" />
                                    <h1>
                                        <field name="name" />
                                    </h1>
                                </div>
                                <field name="content" widget="html" />
                                <group class="oe_edit_only">
                                    <group>
                                        <field name="is_paragraph" />
                                        <field name="agreement_id" invisible="1" />
                                        <field name="resource_ref_model_id" />
                                        <field
                                            name="field_id"
                                            domain="[('model_id', '=', resource_ref_model_id),
                                                        ('ttype', '!=', 'one2many'),
                                                        ('ttype', '!=', 'many2many')]"
                                        />
                                        <field name="sub_object_id" readonly="1" />
                                        <field
                                            name="sub_model_object_field_id"
                                            domain="[('model_id', '=', sub_object_id),
                                                        ('ttype', '!=', 'one2many'),
                                                        ('ttype', '!=', 'many2many')]"
                                            attrs="{'readonly':[('sub_object_id', '=', False)],
                                                       'required':[('sub_object_id', '!=', False)]}"
                                        />
                                        <field name="default_value" />
                                        <field name="copyvalue" />
                                    </group>
                                </group>
                            </sheet>
                        </form>
                    </field>
                </page>
                <page name="aliases" string="Aliases">
                    <field
                        name="alias_ids"
                        context="{'default_agreement_id': active_id}"
                        widget="one2many_list"
                    >
                        <tree editable="bottom">
                            <field name="expression_from" />
                            <field name="expression_to" />
                        </tree>
                    </field>
                </page>
                <page name="help" string="Help">
                    <field name="documentation" />
                </page>
            </xpath>
        </field>
    </record>
</odoo>
